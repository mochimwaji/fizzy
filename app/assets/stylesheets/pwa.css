/* PWA install */
.pwa__instructions {
  @media (display-mode: standalone) {
    display: none;
  }
}

.pwa__installer {
  display: none;

  .pwa--can-install & {
    display: block;
  }
}

/* ==========================================================================
   Touch Drag and Drop Styles
   ========================================================================== */

/* Touch drag preview - the floating element that follows the finger */
.touch-drag-preview {
  pointer-events: none !important;
  user-select: none !important;
  -webkit-user-select: none !important;
  touch-action: none !important;
  will-change: transform, left, top;
}

/* Prevent text selection during drag on touch devices */
.touch-dragging {
  user-select: none !important;
  -webkit-user-select: none !important;
  -webkit-touch-callout: none !important;
}

/* Improve touch targets for draggable items */
@media (any-hover: none) {
  /* Cards in columns should have larger touch targets */
  .card {
    min-height: 64px;
  }
  
  /* Calendar cards need bigger touch targets */
  .calendar__card {
    min-height: 32px;
    padding: 8px 12px;
  }
  
  /* Ensure buttons meet 44x44 minimum touch target */
  .btn--circle,
  .btn--icon {
    min-width: 44px;
    min-height: 44px;
  }
}

/* Visual feedback for long-press on touch devices */
@media (any-hover: none) {
  .card,
  .calendar__card {
    transition: transform 0.15s ease, box-shadow 0.15s ease;
    
    &:active {
      transform: scale(0.98);
    }
  }
}

/* Improve drag visual states for touch */
.drag-and-drop__dragged-item,
.calendar__card--dragging {
  opacity: 0.3;
  transform: scale(0.95);
}

/* Hover container styling for touch drop targets */
.drag-and-drop__hover-container {
  outline: 2px dashed var(--color-selected);
  outline-offset: -2px;
  background-color: var(--dnd-bg-color, rgba(99, 102, 241, 0.1));
}

/* ==========================================================================
   PWA Standalone Mode Enhancements
   ========================================================================== */

@media (display-mode: standalone) {
  /* Slightly larger tap targets in PWA mode */
  .btn {
    min-height: 40px;
  }
  
  /* Remove browser-specific elements in PWA */
  .browser-only {
    display: none !important;
  }
  
  /* Prevent pull-to-refresh interfering with app gestures */
  body {
    overscroll-behavior-y: contain;
  }
  
  /* Safe area handling for notched devices */
  .header {
    padding-top: calc(var(--block-space-half) + env(safe-area-inset-top));
  }
  
  .bar {
    padding-bottom: calc(var(--block-space) + env(safe-area-inset-bottom));
  }
}

/* ==========================================================================
   Mobile Column Navigation
   ========================================================================== */

/* Mobile column navigation in header - only show on touch devices */
.mobile-column-nav {
  display: none;
  
  @media (any-hover: none) {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }
}

.mobile-column-nav__btn {
  min-width: 44px;
  min-height: 44px;
  display: flex;
  align-items: center;
  justify-content: center;
  
  .icon {
    width: 1.25rem;
    height: 1.25rem;
  }
}

.mobile-column-nav__position {
  font-size: var(--text-small);
  color: var(--color-text-secondary);
  white-space: nowrap;
  min-width: 3rem;
  text-align: center;
}

/* Swipe hints that appear during swipe gestures */
.swipe-hint {
  position: fixed;
  top: 50%;
  transform: translateY(-50%);
  padding: 1rem;
  background: rgba(0, 0, 0, 0.7);
  color: white;
  border-radius: 50%;
  z-index: 1000;
  pointer-events: none;
  transition: opacity 0.15s ease;
}

.swipe-hint--prev {
  left: 1rem;
}

.swipe-hint--next {
  right: 1rem;
}

.swipe-hint__arrow {
  font-size: 1.5rem;
  font-weight: bold;
}

/* Slide animations for column transitions */
.slide-out-left {
  animation: slideOutLeft 0.2s ease-out forwards;
}

.slide-out-right {
  animation: slideOutRight 0.2s ease-out forwards;
}

@keyframes slideOutLeft {
  from { transform: translateX(0); opacity: 1; }
  to { transform: translateX(-50px); opacity: 0; }
}

@keyframes slideOutRight {
  from { transform: translateX(0); opacity: 1; }
  to { transform: translateX(50px); opacity: 0; }
}

/* Better card display in column view on mobile */
@media (any-hover: none) {
  .cards--grid {
    touch-action: pan-y;
    
    .card {
      /* Ensure cards are visible and touch-friendly */
      min-height: 64px;
    }
  }
  
  /* Make sure swipe navigation doesn't conflict with card interactions */
  .cards--grid .card {
    touch-action: manipulation;
  }
}